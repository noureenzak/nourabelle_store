<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Checkout ‚Äì Nourabelle</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- Navbar -->
  <header class="navbar">
    <div class="hamburger">&#9776;</div>
    <div class="nav-center">
      <a href="index.html">
        <img src="images/logo.jpg" alt="Nourabelle Logo" class="hero-logo" />
      </a>
    </div>
    <div class="cart-icon-link">
      <a href="cart.html" aria-label="Cart">
        <svg xmlns="http://www.w3.org/2000/svg" class="cart-icon" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
          <path d="M7 18c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2zm10 0c-1.104 
          0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2zM7.333 14l-.867-2H18v-2H7l-.867-2H3v2h2l3.6 
          7.59-1.35 2.44c-.16.29-.25.63-.25 1 0 1.1.9 2 2 2h12v-2H7.42c-.14 
          0-.25-.11-.25-.25l.03-.12L8.1 16h8.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49-1.74-1.01L18.1 
          13H7.333z"/>
        </svg>
        <span id="cart-count" class="cart-count">0</span>
      </a>
    </div>
  </header>

  <!-- Main Checkout Content -->
  <main class="checkout-container">
    <div class="checkout-header">
      <h1 class="checkout-title">Complete Your Order</h1>
      <div class="checkout-steps">
        <div class="step active">1. Information</div>
        <div class="step">2. Payment</div>
        <div class="step">3. Confirmation</div>
      </div>
    </div>

    <div class="checkout-content">
      <!-- Left Side: Form -->
      <div class="checkout-form-section">
        <form id="checkout-form" class="checkout-form">
          <!-- Customer Information -->
          <div class="form-section">
            <h3>Customer Information</h3>
            <div class="form-row">
              <div class="form-group">
                <label for="first-name">First Name *</label>
                <input type="text" id="first-name" name="firstName" required />
              </div>
              <div class="form-group">
                <label for="last-name">Last Name *</label>
                <input type="text" id="last-name" name="lastName" required />
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="email">Email Address *</label>
                <input type="email" id="email" name="email" required />
              </div>
              <div class="form-group">
                <label for="phone">Phone Number *</label>
                <input type="tel" id="phone" name="phone" placeholder="+20..." required />
              </div>
            </div>
          </div>

          <!-- Delivery Address -->
          <div class="form-section">
            <h3>Delivery Address</h3>
            <div class="form-group">
              <label for="street">Street Address *</label>
              <input type="text" id="street" name="street" placeholder="Building number, street name" required />
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="floor">Floor</label>
                <input type="text" id="floor" name="floor" placeholder="e.g. 3rd floor" />
              </div>
              <div class="form-group">
                <label for="apartment">Apartment</label>
                <input type="text" id="apartment" name="apartment" placeholder="Apt number" />
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="area">Area/Neighborhood *</label>
                <input type="text" id="area" name="area" placeholder="e.g. Zamalek" required />
              </div>
              <div class="form-group">
                <label for="city">City *</label>
                <select id="city" name="city" required>
                  <option value="">Select City</option>
                  <option value="cairo">Cairo (50 EGP shipping)</option>
                  <option value="alexandria">Alexandria (60 EGP shipping)</option>
                  <option value="giza">Giza (55 EGP shipping)</option>
                  <option value="other">Other (80 EGP shipping)</option>
                </select>
              </div>
            </div>
            <div id="other-city-group" class="form-group" style="display: none;">
              <label for="other-city">Specify City</label>
              <input type="text" id="other-city" name="otherCity" placeholder="Enter your city" />
            </div>
          </div>

          <!-- Payment Method -->
          <div class="form-section">
            <h3>Payment Method</h3>
            <div class="payment-options">
              <label class="payment-option">
                <input type="radio" name="payment" value="cash" checked />
                <div class="payment-card">
                  <div class="payment-details">
                    <strong>Cash on Delivery</strong>
                    <p>Pay when you receive your order</p>
                  </div>
                  <div class="payment-icon">üíµ</div>
                </div>
              </label>
              <label class="payment-option">
                <input type="radio" name="payment" value="instapay" />
                <div class="payment-card">
                  <div class="payment-details">
                    <strong>InstaPay</strong>
                    <p>Quick mobile payment</p>
                  </div>
                  <div class="payment-icon">üì±</div>
                </div>
              </label>
              <label class="payment-option">
                <input type="radio" name="payment" value="card" />
                <div class="payment-card">
                  <div class="payment-details">
                    <strong>Credit/Debit Card</strong>
                    <p>Secure online payment</p>
                  </div>
                  <div class="payment-icon">üí≥</div>
                </div>
              </label>
            </div>
          </div>

          <!-- Order Notes -->
          <div class="form-section">
            <h3>Order Notes (Optional)</h3>
            <div class="form-group">
              <textarea id="notes" name="notes" placeholder="Any special instructions for delivery..." rows="3"></textarea>
            </div>
          </div>
        </form>
      </div>

      <!-- Right Side: Order Summary -->
      <div class="order-summary-section">
        <div class="order-summary">
          <h3>Order Summary</h3>
          <div id="order-items" class="order-items">
            <!-- Items will be loaded here -->
          </div>
          
          <div class="order-totals">
            <div class="total-line">
              <span>Subtotal:</span>
              <span id="checkout-subtotal">0.00 EGP</span>
            </div>
            <div class="total-line">
              <span>Shipping:</span>
              <span id="checkout-shipping">Select city first</span>
            </div>
            <div class="total-line total">
              <span>Total:</span>
              <span id="checkout-total">0.00 EGP</span>
            </div>
          </div>

          <button type="submit" form="checkout-form" class="place-order-btn" id="place-order-btn" disabled>
            <span>Place Order</span>
            <div class="btn-icon">‚Üí</div>
          </button>

          <div class="security-badges">
            <div class="security-item">
              <span>üîí</span>
              <span>Secure Payment</span>
            </div>
            <div class="security-item">
              <span>üì¶</span>
              <span>Fast Delivery</span>
            </div>
            <div class="security-item">
              <span>‚Ü©Ô∏è</span>
              <span>Easy Returns</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer id="contact">
    <div class="footer-content">
      <a href="https://www.instagram.com/nourabellebynour/" target="_blank" aria-label="Instagram" class="footer-icon-link">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
          <path d="M7.75 2h8.5A5.75 5.75 0 0122 7.75v8.5A5.75 5.75 0 0116.25 22h-8.5A5.75 5.75 0 012 16.25v-8.5A5.75 5.75 0 017.75 2zm0 1.5A4.25 4.25 0 003.5 7.75v8.5A4.25 4.25 0 007.75 20.5h8.5a4.25 4.25 0 004.25-4.25v-8.5A4.25 4.25 0 0016.25 3.5h-8.5zM12 7a5 5 0 110 10 5 5 0 010-10zm0 1.5a3.5 3.5 0 100 7 3.5 3.5 0 000-7zm4.75-.25a1.25 1.25 0 11-2.5 0 1.25 1.25 0 012.5 0z"/>
        </svg>
      </a>
      <a href="mailto:nourabelle@email.com" aria-label="Email" class="footer-icon-link">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
          <path d="M20 4H4a2 2 0 00-2 2v12a2 2 0 002 2h16a2 2 0 002-2V6a2 2 0 00-2-2zm0 2v.01L12 13 4 6.01V6h16zM4 18V8l7.17 5.83a1 1 0 001.66 0L20 8v10H4z"/>
        </svg>
      </a>
      <a href="tel:+201234567890" aria-label="Phone" class="footer-icon-link">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
          <path d="M6.62 10.79a15.093 15.093 0 006.59 6.59l2.2-2.2a1 1 0 011.11-.21 11.436 11.436 0 003.58.57 1 1 0 011 1v3.5a1 1 0 01-1 1A16 16 0 013 5a1 1 0 011-1h3.5a1 1 0 011 1 11.436 11.436 0 00.57 3.58 1 1 0 01-.21 1.11l-2.24 2.1z"/>
        </svg>
      </a>
    </div>
  </footer>

  <!-- JavaScript -->
  <script>
    // Shipping costs
    const shippingCosts = {
      cairo: 50,
      alexandria: 60,
      giza: 55,
      other: 80
    };

    let currentCart = [];
    let currentSubtotal = 0;
    let currentShipping = 0;
    let currentTotal = 0;

    // Get cart from sessionStorage
    function getCart() {
      return JSON.parse(sessionStorage.getItem('cart') || '[]');
    }

    // Update cart count in navbar
    function updateCartCount() {
      const cart = getCart();
      const cartCount = document.getElementById('cart-count');
      if (cartCount) {
        cartCount.textContent = cart.length;
        cartCount.style.display = cart.length > 0 ? 'inline-block' : 'none';
      }
    }

    // Load and display order summary
    function loadOrderSummary() {
      currentCart = getCart();
      const orderItems = document.getElementById('order-items');
      const subtotalSpan = document.getElementById('checkout-subtotal');
      const shippingSpan = document.getElementById('checkout-shipping');
      const totalSpan = document.getElementById('checkout-total');

      // Redirect if cart is empty
      if (currentCart.length === 0) {
        window.location.href = 'cart.html';
        return;
      }

      // Display items
      orderItems.innerHTML = currentCart.map(item => `
        <div class="order-item">
          <img src="${item.image}" alt="${item.name}" />
          <div class="item-details">
            <h4>${item.name}</h4>
            <p>Size: ${item.size}</p>
            <p>Qty: ${item.quantity || 1}</p>
            <p class="item-price">${(item.price * (item.quantity || 1)).toFixed(2)} EGP</p>
          </div>
        </div>
      `).join('');

      // Calculate subtotal
      currentSubtotal = currentCart.reduce((sum, item) => sum + (item.price * (item.quantity || 1)), 0);
      
      // Update display
      subtotalSpan.textContent = `${currentSubtotal.toFixed(2)} EGP`;
      
      // Update total based on current shipping
      updateOrderTotal();
    }

    // Update order total when city changes
    function updateOrderTotal() {
      const citySelect = document.getElementById('city');
      const shippingSpan = document.getElementById('checkout-shipping');
      const totalSpan = document.getElementById('checkout-total');
      const placeOrderBtn = document.getElementById('place-order-btn');
      
      if (citySelect.value) {
        currentShipping = shippingCosts[citySelect.value] || 80;
        currentTotal = currentSubtotal + currentShipping;
        
        shippingSpan.textContent = `${currentShipping.toFixed(2)} EGP`;
        totalSpan.textContent = `${currentTotal.toFixed(2)} EGP`;
        
        placeOrderBtn.disabled = false;
      } else {
        currentShipping = 0;
        currentTotal = currentSubtotal;
        
        shippingSpan.textContent = 'Select city first';
        totalSpan.textContent = `${currentSubtotal.toFixed(2)} EGP`;
        
        placeOrderBtn.disabled = true;
      }
    }

    // Handle city change
    function handleCityChange() {
      const citySelect = document.getElementById('city');
      const otherCityGroup = document.getElementById('other-city-group');
      const otherCityInput = document.getElementById('other-city');
      
      if (citySelect.value === 'other') {
        otherCityGroup.style.display = 'block';
        otherCityInput.required = true;
      } else {
        otherCityGroup.style.display = 'none';
        otherCityInput.required = false;
      }
      
      updateOrderTotal();
    }

    // Handle form submission
    function handleFormSubmit(e) {
      e.preventDefault();
      
      const formData = new FormData(e.target);
      
      // Validate required fields
      const requiredFields = ['firstName', 'lastName', 'email', 'phone', 'street', 'area', 'city'];
      const missingFields = requiredFields.filter(field => !formData.get(field));
      
      if (missingFields.length > 0) {
        alert(`Please fill in all required fields: ${missingFields.join(', ')}`);
        return;
      }

      if (currentCart.length === 0) {
        alert('Your cart is empty');
        return;
      }

      if (!document.getElementById('city').value) {
        alert('Please select your city for shipping calculation');
        return;
      }
      
      // Create order object
      const order = {
        id: 'ORD' + Date.now(),
        customerName: `${formData.get('firstName')} ${formData.get('lastName')}`,
        customerEmail: formData.get('email'),
        customerPhone: formData.get('phone'),
        address: {
          street: formData.get('street'),
          floor: formData.get('floor') || '',
          apartment: formData.get('apartment') || '',
          area: formData.get('area'),
          city: formData.get('city') === 'other' ? formData.get('otherCity') : formData.get('city')
        },
        items: currentCart,
        paymentMethod: formData.get('payment'),
        notes: formData.get('notes') || '',
        subtotal: currentSubtotal,
        shipping: currentShipping,
        total: currentTotal,
        status: 'pending',
        createdAt: new Date().toISOString()
      };

      // Save order to localStorage
      const orders = JSON.parse(localStorage.getItem('nourabelle_orders') || '[]');
      orders.push(order);
      localStorage.setItem('nourabelle_orders', JSON.stringify(orders));

      // Clear cart
      sessionStorage.removeItem('cart');
      sessionStorage.removeItem('nourabelle_subtotal');
      sessionStorage.removeItem('nourabelle_shipping');
      sessionStorage.removeItem('nourabelle_total');

      // Save last order for confirmation page
      sessionStorage.setItem('lastOrder', JSON.stringify(order));

      // Show success message
      alert(`Thank you ${order.customerName}! Your order #${order.id} has been placed successfully. We'll contact you soon to confirm your order.`);

      // Redirect to home page (or you can create a thank you page)
      window.location.href = 'index.html';
    }

    // Initialize page
    document.addEventListener('DOMContentLoaded', function() {
      updateCartCount();
      loadOrderSummary();

      // Set up event listeners
      document.getElementById('city').addEventListener('change', handleCityChange);
      document.getElementById('checkout-form').addEventListener('submit', handleFormSubmit);
    });
  </script>

  <style>
    /* Checkout Page Specific Styles */
    .checkout-container {
      max-width: 1200px;
      margin: 80px auto 40px;
      padding: 20px;
    }

    .checkout-header {
      text-align: center;
      margin-bottom: 40px;
    }

    .checkout-title {
      font-size: 2.5rem;
      color: var(--btn);
      font-weight: 600;
      margin-bottom: 20px;
    }

    .checkout-steps {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 30px;
    }

    .step {
      padding: 8px 16px;
      border-radius: 20px;
      background: #f5f5f5;
      color: #666;
      font-size: 0.9rem;
      transition: all 0.3s;
    }

    .step.active {
      background: var(--btn);
      color: white;
    }

    .checkout-content {
      display: grid;
      grid-template-columns: 1fr 400px;
      gap: 40px;
    }

    .form-section {
      background: white;
      padding: 25px;
      border-radius: 12px;
      margin-bottom: 20px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    .form-section h3 {
      color: var(--btn);
      margin-bottom: 20px;
      font-size: 1.3rem;
      border-bottom: 2px solid var(--accent);
      padding-bottom: 10px;
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #444;
    }

    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 1rem;
      transition: border-color 0.3s;
    }

    .form-group input:focus,
    .form-group textarea:focus,
    .form-group select:focus {
      outline: none;
      border-color: var(--btn);
      box-shadow: 0 0 0 3px rgba(173, 124, 124, 0.1);
    }

    .payment-options {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .payment-option {
      cursor: pointer;
    }

    .payment-option input[type="radio"] {
      display: none;
    }

    .payment-card {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px;
      border: 2px solid #eee;
      border-radius: 12px;
      transition: all 0.3s;
      background: white;
    }

    .payment-option input[type="radio"]:checked + .payment-card {
      border-color: var(--btn);
      background: rgba(173, 124, 124, 0.05);
    }

    .payment-card:hover {
      border-color: var(--btn);
    }

    .payment-details strong {
      display: block;
      margin-bottom: 4px;
      color: var(--text);
    }

    .payment-details p {
      margin: 0;
      color: #666;
      font-size: 0.9rem;
    }

    .payment-icon {
      font-size: 1.5rem;
    }

    .order-summary {
      background: white;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      position: sticky;
      top: 100px;
      height: fit-content;
    }

    .order-summary h3 {
      color: var(--btn);
      font-size: 1.3rem;
      margin-bottom: 20px;
      border-bottom: 2px solid var(--accent);
      padding-bottom: 10px;
    }

    .order-item {
      display: flex;
      gap: 15px;
      padding: 15px 0;
      border-bottom: 1px solid #eee;
    }

    .order-item:last-child {
      border-bottom: none;
    }

    .order-item img {
      width: 60px;
      height: 60px;
      object-fit: contain;
      border-radius: 8px;
    }

    .item-details h4 {
      margin: 0 0 5px 0;
      font-size: 1rem;
      color: var(--text);
    }

    .item-details p {
      margin: 0;
      color: #666;
      font-size: 0.9rem;
    }

    .item-price {
      font-weight: 600;
      color: var(--btn) !important;
    }

    .order-totals {
      margin: 20px 0;
      padding: 20px 0;
      border-top: 1px solid #eee;
    }

    .total-line {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
      font-size: 1rem;
    }

    .total-line.total {
      font-weight: 600;
      font-size: 1.2rem;
      color: var(--btn);
      border-top: 1px solid #eee;
      padding-top: 10px;
      margin-top: 10px;
    }

    .place-order-btn {
      width: 100%;
      padding: 16px;
      background: var(--btn);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
      transition: all 0.3s;
      margin-bottom: 20px;
    }

    .place-order-btn:hover:not(:disabled) {
      background: var(--btn-hover);
      transform: translateY(-2px);
    }

    .place-order-btn:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }

    .security-badges {
      display: flex;
      justify-content: space-around;
      margin-top: 20px;
      padding-top: 20px;
      border-top: 1px solid #eee;
    }

    .security-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
      font-size: 0.8rem;
      color: #666;
    }

    .security-item span:first-child {
      font-size: 1.2rem;
    }

    /* Mobile Responsive */
    @media (max-width: 768px) {
      .checkout-content {
        grid-template-columns: 1fr;
        gap: 20px;
      }

      .form-row {
        grid-template-columns: 1fr;
        gap: 15px;
      }

      .checkout-steps {
        flex-direction: column;
        align-items: center;
        gap: 10px;
      }

      .order-summary {
        position: static;
      }
    }

    /* Tablet Responsive */
    @media (max-width: 1024px) and (min-width: 769px) {
      .checkout-content {
        grid-template-columns: 1fr 350px;
        gap: 30px;
      }
    }
  </style>
</body>
</html>